# 브라우저의 렌더링 과정

## 리플로우와 리페인트

하드디스크랑 메모리는 같이 묶는거다. 

하드디스크에 있는 파일이 메모리에 들어와야 읽엇다 라고 할수있다. 

파싱 : < 이것도 2진수로 있을것이다. < (꺽쇠) 가 나오면 그 뒤에 뭐가 나올지 정해져있다. HTML, div 등등.. 근데 우리가 dix 라고 쓰면 어케 될까? 에러 안나와. 근데 유의미한 애들이 나오면 어떻게 동작할지 안다. 이게 문법이다. 그래서 우리가 파싱할때, 중요한 단위가 뭘까? 토큰은 어떤 의미를 갖냐? 토큰 얘기할때 핵심은 "유의미" 이다. 

html은 뭘 나타내기위해쓴다고? 정보와 구조를 나타내기 위해 쓰는거다. 

정보라는 것은 태그와 태그 사이에 컨텐츠 라는 걸 말하고 구조는 중첩 관계에 의해서 부자관계 또는 형제관계를 가지게 되는것을 말한다. 

컨텐츠 안에 있는 텍스트 등 유의미 한 것들을 토큰이라고 한다. 이런 토큰들은 노드 라는 것으로 만든다. 노드라고 하면, 객체라고 알고 있어야 한다. 트리객체상에 있는 객체.

유의미한것들이 노드를 만들것이다. 따라서 노드에는 종류가 8,9 개 있는데 우리에게 중요한건 4개다.

첫번째. 문서노드.

도큐먼트는 돔 트리의 루트다. 라고 말할 수 있다. 예를 들어서 요소들로 우리가 노드를 만들엇다고 하면 그 노드가 트리구조를 이루게 되는데, 걔한테 어케 접근할래? 라고 물어보는거다. 트리구조는 항상 루트를 통해서 들어가야 한다. 들어가게 되면 언제든지 우리는 그 돔 트리에 들어갈수 있어야 한다. 그러면 그 돔트리의 진입점이 항상 존재해야 한다. 윈도우 객체의 프로퍼티로 존재한다. 

윈도우.프로퍼티는 노드다. 그 도큐먼트 객체를 문서 노드라고 한다.  

두번째. 요소노드.

예를 들어서 html이 이런식으로 생겻잖아요(메모장 보기) 결국은 얘도 CRUD다. 

요소노드에 접근할수 있으면 할게 많다. 

세번째. 어트리뷰트 노드

네번째. 텍스트 노드

노드들이 모여서 거대한 트리가 만들어진다. 

![image-20200525134933446](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525134933446.png) 

<링크 렐> 이 상태에서는 화면 하얀 상태이다.

![image-20200525135545213](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525135545213.png) 

그래서 렌더 트리로 페인팅 한거다. 

![image-20200525141634354](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525141634354.png) 

---

---

# DOM

트리구조라고 하는건 일반적인 트리구조를 이루고 잇다. 

 여러개의 자료구조를 담는건 html 컬렉션과 노드리트스가 있다. 근데 두개 다 쓰지 말고 무조건 배열로 만들자. 



html파일에서 script 태그 사이에서 document.get 해서 나오는 것들중에 엘리먼트s 이렇게 s 나오는건 쓰지 마라. 

![image-20200525151956017](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525151956017.png) 

### 새니티제이션

웹 프로그래머가 백엔드한테 욕먹은거야.

살균한다: 문자열 안에 이너 에칭티멩 할당한 문자열 안에 스크립트가 있으면 전부 무력화 시키는 거다. 우리가 코딩하지 말고 라이브러리 쓰자. 

 

이너 에치티멜 문제가 있다는것만 알고 있고 그냥 쓰자. 

![image-20200525154437320](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525154437320.png) 

또 하나의 문제점이 있다.

삽입되있는 요소의 위치를 지정할수 없다. 

그래서 아래같은 것들이 나왓다. 

![image-20200525154516012](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525154516012.png) 

위 코드는 위치를 지정할수 있다.

![image-20200525160025825](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525160025825.png) 

1. 맨첨에 요소 노드 객체를 만든다(크리에이트엘리먼트)

   요소 객체가 만들어지는데 기존 돔이랑 따로 떨어져있는거다.

2. 텍스트 노드 객체를 만든다(크리에이트 텍스트노드)

3. 텍스트 노드를 요소 노드의 자식 노드로 추가하기(어펜드차일드)

   이렇게 묶어주면 따로따로 존재하던게 이어진다. 이어진것들도 기존 돔에 연결은 안되있는 상태다.

4. 어느 기존 돔에 자식으로 우리가 만든 요소 노드와 텍스트노드 묶어준걸 자식의 노드로 이어준다.

​     



콜스펜은 ... 없다.

텍스트컨텐트 라고 하는 어트리뷰트는 있나? 들쭉날쭉하다. 

클래스라고 하는 어트리뷰트가 있는데,  클래스라고 하는 프로퍼티가 있을거 같아? 왜 없을거 같아? 클래스라는 프로퍼티를 굉장히 만들고 싶었겠지만 예약어라서 없다. 

디폴트 css 가 브라우저마다 달라서 리셋을 해야 한다. 어떤 리셋 css   를 쓸거냐? 

클래스리스트는 객체다. 



---

---

---

# 이벤트

에치티멜 요소라는 것들은 기본적으로 이벤트를 발생 시킬수 있다. 

그 이벤트를 브라우저는 감지할수 있는 능력이 있다. 

그러면 우리는 어떤식으로 코딩하냐면 브라우저한테 어떤 요소에서 어떤 이벤트가 발생하면 이런 일을 해줘 라고 부탁하는거다. 이런일을 해줘 라고 하는 건 함수만드는거다. 

그리고 이벤트 객체라는걸 조심하면 된다.

그래서 이벤트에는 종류라는 것들이 존재한다.

## 마우스 이벤트

제일 흔한 이벤트가 클릭이다. 

클릭도 일반 클릭과 더블클릭이 있다. 클릭이라는게 좀더 분리해보면 어떻게 되냐면 마우스 왼쪽 버튼을 누른다가 1번이고 그게 마우스 다운이다. 누르면 띠겠지. 띨거에요. 그게 마우스업이다. 

그러면 마우스 무브는 뭘까? 마우스를 이동시킬수 있겟지? 그때 마우스 무브 이벤트가 발생한다. 

마우스 무브 이벤트를 하면 어떤 정보를 브라우저가 캐치할까요? 그냥 움직엿다 이럴꺼 같아? 마우스 커버 위치 좌표 정보가 계속 바뀌는 것이다. 그러면 굉장히 빠른 간격으로 마우스 좌표 정보를 계속 채키 한다.

마우스 클릭하면 클릭한 좌표를 읽는다. 

그래서... 마우스 좌표 정보가 따라다닌다. 

마우스 이벤트를 보면 좌표 정보를 알수 잇어야 한다. 

마우스 엔터가 호버이고, 마우스 리브는 커서가 올라갔다 빠지는 거다

## 키보드 이벤트

키보드 키마다 번호가 달려있다. 그 번호 정보를 브라우저가 캐치한다.

엔터키는 13번이다. 그럼 우리는 엔터키가 눌려졌다는걸 감지할수 있다. 그러면 엔터키가 눌려지면 뭘 해줘. 라고 만들어서 브라우저한테 알리는 거다.

## 포커스 이벤트

포커스가 들어왔다. 포커스가 빠졌다. 

##  폼 이벤트

서브밋 버튼을 눌렀을때 서브밋 이벤트가 발생한다.

## 값 변경 이벤트

인풋 타입 텍스트 에다가 값을 한자, 한자, 한자 넣잖아요? 그때마다 인풋 이벤트가 발생한다.

체인지 이벤트는 조금 헷갈리는건데 얘도 인풋에서만 발생한다. 한자 한자 넣는게 바꼈다는 건데 여기서는 포커스를 밀었을때 라고 한다. 

또 하나, 체크박스를 클릭할때마다 체인지 이벤트가 발생한다.

## 뷰 이벤트

리사이즈 : 사이즈를 줄였다 늘엿따

스크롤 : ...

## 이벤트 헨들러

어떤 이벤트가 발생하면 어떤 일을 해달라고 브라우저한테 부탁할때 무슨일을 부탁하는 함수를 이벤트 핸들러라고 한다. 

결국 우리는 이벤트 헨들러를 만들어서... 여기에 넣으면 된다. 

### 이벤트 헨들러 등록

![image-20200525171624358](C:\Users\강호승\AppData\Roaming\Typora\typora-user-images\image-20200525171624358.png) 

```html
<script>
const $button = document.querySelector('button');
    console.dir($button);
    
    let num = 0;
    $button.onclick = function (){
        $button.textContent = ++num
    }
</script>
-------------------------------------------------
// 클릭할때마다 숫자가 늘어나는 이벤트이다.
```

```html
<body>
    <input type = "text" placeholder = "todo">


<script>
const $input = dociment.querySelector('input[type=text]');
    console.log($input)l
    $input.onkeyup = function (e){
        //엔터키
        if(e.keyCode !=== 13) return;
        console.log($input.value);
        console.log(e.target.value);
    };
</script>
    </body>
```

위 코드에서 인수를 전달하는데 그 인수가 이벤트 객체다. 

캡쳐링을 잡던지, 버블링을 잡던지.

```HTML
<body>
    <ul class="todos">
        <li>HTML</li>
        <li>CSS</li>
        <li>JS</li>
    </ul>
</body>
<script>
    const $ul = document.querySelector('.todos');
    [...$ul.children].forEach($li => {
        $li.onclick = function (e) {
            console.log(e.target.textContent);
        };
    });
</script>
```

... 실제로 이벤트를 발생시킨 요소를 말한다.

그리고 키프레이스 같은 키보드 이벤트가 발생했을때는 ... 이벤트 객체가 넘어오는데... 키코드....

.. 할수도 있다. 

똑같은 이벤트를 처리하는 ... 부모에게 한번만 달아줄수도 있을것이다.

그때 주의할것은 필터링... 





예습: 36장, 40장. 







