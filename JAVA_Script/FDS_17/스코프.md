# `스코프`란?

> "<u>유효범위</u>"
>
> "JS엔진이 식별자를 찾는 규칙을 스코프라고 한다."
>
> 스코프라고 하는 문법을 통해서 식별자를 찾으러 다닌다.

스코프는 식별자와, 그리고 함수하고 관련이 있다. <br>예를 들어서, 함수의 매개변수는 함수 몸체 내부에서만 참조할수 있고, 유효하다고 누차 얘기해왔다.<br>즉, **매개변수**의 유효범위. 즉 **스코프는 함수 몸체 내부**라고도 말할 수 있는 것이다. 

```js
ex) 매개변수의 스코프는 함수 몸체 내부이다.

function add(x, y) {
console.log(x, y) 
return x + y;
}
add(2, 5);      // 2 5 
				//매개변수 x, y는 함수 몸체 내부에서만 유효하여, 참조 가능하다.
-----------------
console.log(x, y) // ReferenceError
				 // 매개변수 x, y 는 함수 외부 영역에서는 참조할수 없다. 
```

---

또한, var 키워드로 선언한 변수는 같은 스코프 내에서 중복 선언이 허용되며, 함수 내부만 지역으로 인정한다. 	그 외의 키워드로 선언한 변수(let이나 cont)는 코드블록도 스코프로 인정한다.  														  -> 중복 선언이 되어져도 에러를 발생시키지 않는다. 하지만 값의 재할당으로 인해서 값이 바뀔뿐 아니라. ES6 부터는 let이나 const 는 에러를 발생시킨다.

```js
function foo () {
var x = 1;
var x = 2;
console.log(x);
}
foo();
---------------------
// 위 코드는 함수 몸체 내부안에 있는 변수 x 는 하나의 스코프 안에서 동일한 변수를 중복 사용한 상황이다. 
중복 사용하여도 에러는 안나지만 값의 재할당으로 인해서 값이 바뀐다. 
```

---

위에서 언급했듯이, JS엔진이 스코프에서 식별자를 찾아다니는데, 하위 스코프에서 상위 스코프로 즉, 아래에서 위로 찾아다니는 모습의 자료구조를 보고 "단방향 링크"라고 한다. 

- 단방향 링크 : 상위 스코프에서 유효한 변수는 하위 스코프에서 자유롭게 참조가 가능하지만, 하위 스코프에서 유효햔 변수를 상위 스코프에서 참조 할수 없다.



## 전역 스코프 

- 전역 스코프 내의 전역 변수는 어디서든 참조할 수 있다.

- <u>함수 몸체 밖에서 var 키워드로 선언된 변수는 코드 블록 내에서 선언되었다 하더라도 모두 전역 변수이다.</u>
- **<u>함수 객체가 전역 스코프에서 만들어질때, 런타임 이전에 식별자를 선언하고, 함수 객체를 만들고 할당까지 끝마친다.</u>** 

## 지역 스코프

함수  몸체 내부의 영역을 지역 스코프라고 하며 변수 자신의 지역 스코프와 하위 지역 스코프에서 유효하다. 

## (전역 스코프& 지역 스코프 )스코프 정리

"렉시컬 스코프"

![캡쳐96](https://user-images.githubusercontent.com/62126380/81477010-ffce4000-924f-11ea-93de-e7a671de16fb.PNG) 



```js
var x = 1;
function foo (){
    var x = 10;
    bar ();
}
function bar (){
    console.log(x);
}
foo();
bar();
--------------------------------
// 전역 스코프 안의 변수와 지역 스코프 안의 변수가 동일한 이름의 식별자이지만 다른 식별자이다. 
   스코프가 다른 변수는 서로 다른 식별자이다.
// 1. 전역 스코프: 전역 스코프에 전역 변수로 x 와 foo 와 bar 가 만들어지고, 
   각각 값은 undefined, 함수 객체 2개가 만들어진다.
// 2. 런타임이 실행되면서 변수 x의 값은 1 로 재할당이 되며 foo 함수가 호출이 된다.
// 3. foo 함수를 호출하려면 foo함수를 찾아야 하는데, 보니까 foo 함수는 전역 스코프에 있다. 스코프 내에 변수가 있으면 
   호출이 가능하므로 foo 함수의 지역 스코프가 만들어진다.
// 4. 지역 스코프: foo의 지역 스코프 내에서 x 가 undefined로 할당되었다가 초기화가 되고 10 이 재할당되어진다. 
   그리고 bar 함수가 호출이 된다.
// 5. bar 함수를 호출하려면 bar 함수를 찾아야 하는데, 찾아보니까 bar 함수는 지역 스코프에 없다. 
   그래서 상위 스코프로 찾으러 가보니까 젼역 스코프에 있었다. 
   스코프 내에 변수가 있으면 호출이 가능하므로 bar 함수의 지역 스코프가 만들어진다.
// 6. bar 함수의 지역 스코프를 보니 변수 선언이 되어있지 않고 변수 x 를 출력하라는 console.log만 찍혀있다. 
   그래서 변수 x 를 보니까 같은 지역 스코프에 없어서 상위 스코프인 전역 스코프를 보니까 
   변수 1로 값이 할당된 x 가 있다. 
// 결과값 1 1 이란 값이 도출된다.
```

- 자바스크립트를 비롯한 대부분의 프로그래밍 언어는 렉시컬 스코프를 따른다.

- **<u>함수를 어디서 호출했는지 가 아니라 함수를 어디서 정의했는지에 따라서 상위 스코프를 결정한다.</u>**

- JS엔진은 식별자는 스코프 체인에서 찾고, 프로퍼티는 프로퍼티 체인에서 찾는다. 스코프 체인과 프로퍼티 체인 두개가 같이 협력하면서 코드가 실행되어진다. 
- 식별자가 등록이 되면 어딘가에 기억을 해야 하는데, 이때 <u>자료구조</u>를 만들어서 기억을 한다. 그 자료구조를 "실행 컨텍스트" 라고 한다. 실행 컨텍스트에 식별자가 등록이 될때 스코프를 구분해서 등록이 된다. 


