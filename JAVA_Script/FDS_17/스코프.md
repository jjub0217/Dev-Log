# 스코프란?

들어가기에 앞서

>스코프는 변수와 함수와 깊은 관련이 있다.

><u>전역 스코프</u>
>
>- 코드의 가장 바깥 영역
>
>  <u>전역변수</u>
>
>  - 코드의 가장 바깥 영역에서 선언된 변수
>
><u>지역 스코프</u>
>
>- 함수 몸체 내부 영역
>
>- <u>코드블록문 내부 영역</u> 
>
>  > 1. var 키워드로 선언된 변수는 함수 몸체 내부만 지역 스코프로 인정한다.
>  >
>  > 2. let 이나 const 키워드로 선언된 변수는 함수 몸체 내부 뿐 아니라, 코드 블록문 내부 영역도 지역 스코프로 인정한다. : 이때의 코드 블록문 내부를 "블록 레벨 스코프"라 한다

---

- **<u>변수(식별자)나 함수를 선언할때 유효한 범위</u>**를 의미한다. 즉, 식별자가 유효한 범위를 뜻한다. 
- 변수는 코드의 가장 바깥 영역 뿐 아니라, 코드 블록문의 내부와 함수 몸체 내부 안에서도 선언할수 있다. 
  - 함수의 매개변수도 식별자이기 때문에 스코프가 존재한다. 
  - 함수의 매개변수는 함수 몸체 내부에서만 살아 움직이기 때문에, **매개변수의 스코프는 함수 몸체 내부**이다. ( 자신의 스코프가 아닌 영역에서는 자신은 죽게 되므로 무효화가 되서, **<u>자신의 영역이 아닌 곳에서는 참조할수 없다.</u>**)
- 👆  <u>**변수(변수 이름, 함수이름, 클래스 이름 등)는 자신이 선언된 위치가 어딘지냐에 따라서, 변수 자신의 스코프가 결정된다.**</u>
- JS엔진은 스코프체인을 통해 어떤 변수를 참조(사용)해야 할지 결정하기 때문에, 스코프는 👆 **'식별자를 검색할 때 사용하는 규칙'**이라고도 한다.

## 1. 전역 

### 1-1. 전역 스코프

---

- 코드의 가장 바깥 영역을 말한다.

### 1-2. 전역변수

---

- 코드의 가장 바깥 영역에서 선언된 변수를 말한다.

- 전역변수는 어떤 영역에서든지 참조할수 있다. 

  ```javascript
  
  let globalParameter = '전역변수';  //
  -------------------------------------------
      
  function global(){
    console.log(`여기는 지역 스코프 영역이지만, ${globalParameter}를 참조(사용)할수 있다.`);
  }
  global(); //
  
  -------------------------------------------
  
  if(true){
    console.log(`여기는 코드 블록문 영역이지만, ${globalParameter}를 참조(사용)할수 있다.`);
  } //
  
  -------------------------------------------
  
  console.log(`여기는 ${globalParameter}를 참조(사용)할수 있는 전역 스코프이다`);
  
  
  ```
  
  ```javascript
  var globalParameter = '전역변수'; 
  
  function global() {
    console.log(`여기는 지역 스코프 영역이지만, ${globalParameter}를 참조(사용)할수 있다.`);
    var x = 'local 함수 scope내의 변수'
  }
  global(); //
  
  
  if (true) {
    var y = 'local 코드블록문 내의 변수'
    console.log(`여기는 코드 블록문 영역이지만, ${globalParameter}를 참조(사용)할수 있다.`);
  } //
  
  
  console.log(`여기는 ${globalParameter}를 참조(사용)할수 있는 전역 스코프이다`);
  console.log(y); // local 코드블록문 내의 변수
  console.log(x); // Reference Error : var 키워드로 함수 몸체 내부에서 선언한 변수는 지역변수이기 때문에
                  // 이렇게 전역에서 참조할수 없다
  ```

## 2. 지역

### 2-1. 지역 스코프

---

1. 함수 레벨 스코프(함수 몸체 내부 영역) : var 키워드로 선언된 변수는 함수 몸체 내부 영역의 코드 블록만 지역 스코프로 인정한다.

2. 블록 레벨 스코프( 코드블럭문 내부 영역) : let 이나 const 키워드로 선언된 변수는 함수 몸체 내부 영역 뿐 아리나 모든 코드 블록문 내부를 지역 스코프로 인정한다

### 2-2. 지역변수

---

- 함수 몸체 내부 영역이나, 코드블록문 내부 영역에서 선언한 변수를 말한다.

- 지역 변수는 자신이 선언된 영역과, 자신이 선언된 영역 밑에 중첩된 함수 몸체 내부 영역에서 참조(사용) 할수 있다.

-  서로 다른 스코프에서( 전역 스코프와 지역스코프 등) 동일한 이름의 변수를 사용할수는 있지만, 지역변수는 지역 스코프 내에서만 참조할수 있다. ( 지역 스코프 외부에서는 참조(사용)할수 없다. )

  ![231](https://user-images.githubusercontent.com/62126380/93469148-0b7ef100-f92b-11ea-87fe-eecbe9ee26fc.jpg)    

  ![2577d](https://user-images.githubusercontent.com/62126380/93469272-3bc68f80-f92b-11ea-8478-c374a378fcb3.jpg)

## 3. 블록 레벨 스코프

-  var 키워드로 선언된 변수는 함수 몸체 내부 영역만을 지역 스코프로 인정하지만,<br>let 이나, const 키워드로 선언된 변수는 함수 몸체 내부 뿐 아니라, 모든 코드블럭문 내부 영역을 지역 스코프로 인정한다 : 이때의 스코프를 "블록 레벨 스코프" 라고 한다. 

  ```javascript
  function fastCamplus(){
  	var number = 16;// <---┐
      var number = 17;// <---┘ 같은 스코프 안에서 var 로 선언하는 변수는 중복선언이 가능하다. -> 재할당된다.
      console.log(number)//    서로 다른 식별자로 만들이 위해 각각 변수에 var 키워드를 사용해도
      		}//				 var 키워드가 없는 것처럼 동작한다. 
  fastCamplus(); // 17
  ```

  ```javascript
  function fastCamplus(){
  	let number = 16;// <---┐
      let number = 17;// <---┘ 같은 스코프 안에서 let 으로 선언하는 변수는 중복선언이 불가능하다 -> 에러난다.
      console.log(number)
  }
  fastCamplus(); // Syntax Error
  
  function fds(){
  	const fdsNumber = 16;// <---┐
      const fdsNumber = 17;// <---┘ 같은 스코프 안에서 const 로 선언하는 변수는 중복선언이 불가능하다 -> 에러난다.
      console.log(number)
  }
  fastCamplus(); // Syntax Error
  ```

## 렉시컬 스코프

- <u>**함수를 어디서 정의했는지에 따라 함수의 상위 스코프를 결정하는 방식**</u>을 뜻한다.

- 함수 정의가 평가되는 시점에 상위 스코프가 정적으로 결정되는 것이기 때문에 정적 스코프라고도 한다.

- 모든 함수 정의는 함수 객체를 생성할때, 자신이 정의된 영역(자신의 스코프)를 기억한다. <br>그러면서, 자신이 기억하고 있는 영역(자신이 정의된 스코프)을 상위 스코프로 사용한다.

  ```javascript
  var x = 1;
  
  function foo(){
      var x = 10;
      bar(); // : 전역에 있는 x 라는 변수를 콘솔에 출력하는 함수이다. : 1
  }
  function bar(){
      console.log(x); // : bar 지역스코프에서 변수 x 를 검색한다  
      				//	 -> 없네? 없으니까 상위 스코프인 전역 스코프를 바라본다.
      				//   -> 전역에 x 라는 변수가 있다. 그 변수의 값을 참조한다.
  }
  
  foo(); // 1
bar(); // 1
  ```
  

## 스코프 체인( 전역스코프와 지역스코프와의 상관관계 )

- 함수는 중첩이 될수 있으므로 함수의 지역 스코프도 중첩될 수 있다. <br>즉, 스코프는 함수의 중첩에 의해 계층적 구조를 갖는다.

- 외부 함수의 스코프(지역 스코프)가 중첩함수의 상위 스코프다.

  ![334d](https://user-images.githubusercontent.com/62126380/93477164-9cf36080-f935-11ea-9885-75c7999bcd7e.JPG) 

  - 모든 스코프는 하나의 계층적 구조로 연결되며, 모든 지역 스코프의 최상위 스코프는 전역 스코프이다.
  - JS엔진이 변수를 참조(사용)할때는 스코프체인을 통해서, 각각의 변수를 참조하는 코드( 위 예시 이미지에서는 console.log(x) /console.log(y) /console.log(z) 를 말한다)가 있는 스코프에서, 시작해서, 위로위로 상위 스코프의 방향으로 이동하면서 선언된 변수를 검색한다. 



